name: Build + Deploy to GitHub Pages

on:
  push:
    branches:
      - main # –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞—Ç—å –ø—Ä–∏ –ø—É—à–µ –≤ –≤–µ—Ç–∫—É main
  workflow_dispatch: # –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞ –≤—Ä—É—á–Ω—É—é

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pages: write # –ù–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è actions/deploy-pages
      id-token: write # –ù–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è actions/deploy-pages

    # !!! –î–û–ë–ê–í–õ–ï–ù–û: –£–∫–∞–∑—ã–≤–∞–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –¥–µ–ø–ª–æ—è !!!
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }} # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Å—Å—ã–ª–∫–∞ –Ω–∞ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–π —Å–∞–π—Ç

    steps:
      - name: Checkout üèóÔ∏è
        uses: actions/checkout@v4

      - name: Enable Corepack
        run: corepack enable

      - name: Setup Node.js üõ†Ô∏è
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: 'yarn'

      - name: Install dependencies üì¶
        run: yarn install --immutable

      - name: Build website üî®
        run: yarn build

      # –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–æ–≤—ã–π, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–± –¥–µ–ø–ª–æ—è –Ω–∞ GitHub Pages —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ actions
      - name: Setup Pages
        uses: actions/configure-pages@v5

      - name: Upload artifact for Pages
        uses: actions/upload-pages-artifact@v3
        with:
          path: './dist'

      - name: Deploy to GitHub Pages üöÄ
        id: deployment # –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º ID, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ —Å–æ—Å–ª–∞—Ç—å—Å—è –Ω–∞ output
        uses: actions/deploy-pages@v4